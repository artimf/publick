# --- ВИЗУАЛИЗАЦИЯ РОЛЕЙ ---
if not filtered_df.empty:
    st.subheader("Распределение ролей")

    # Подсчёт ролей
    role_counts = filtered_df['role'].value_counts()

    # Построение графика
    plt.figure(figsize=(10, 5))
    sns.set_style("whitegrid")
    ax = sns.barplot(x=role_counts.values, y=role_counts.index, palette="viridis")

    # Добавление числовых меток
    for i, (value, role) in enumerate(zip(role_counts.values, role_counts.index)):
        ax.text(value + 0.1, i, str(value), va='center', ha='left', fontsize=10, fontweight='bold')

    plt.xlabel("Количество серверов")
    plt.ylabel("Роль")
    plt.title("Распределение ролей по серверам")

    st.pyplot(plt)
